# Scamwall AI: Hybrid Fraud App Detection System 🛡️

**AIがインストール前に「詐欺・不審アプリ」を見抜く。セキュリティに革新を。**

Scamwallは、Androidのアクセシビリティサービスを活用してGoogle Playストアの情報をリアルタイムに抽出し、軽量NLPモデル（BERT）と強力なLLM（Gemini 1.5 Flash）を組み合わせた「ハイブリッド判定」を行うセキュリティソリューションです。

---

## 📅 開発ステータス (2026年2月11日時点)

- [x] **[2026/02/05]** BERT-base-japanese-v3 によるモデル構築完了（Accuracy: 83.8%）
- [x] **[2026/02/11]** FastAPIによるバックエンドAPIの構築完了
- [x] **[2026/02/11]** 量子化モデル（PTH）を用いたメモリ節約推論の実装
- [x] **[2026/02/11]** Google Cloud RunへのDockerコンテナデプロイ成功（本番稼働中）
- [ ] **[NEXT]** Androidクライアント（Kotlin）とのAPI連携実装

---

## 📱 プロジェクト概要

「クリーナーアプリ」を装った広告詐欺や、過剰な権限要求を行う不審なアプリからユーザーを保護します。Playストアの「インストール」ボタンを押す直前に、背後でAIがアプリの危険性をスコアリングします。

### 🧠 ハイブリッド・リスクスコアリングの論理
コスト・速度・精度のトレードオフを解決するため、独自の2段階判定（階層化アーキテクチャ）を採用しています。

| 段階 | エンジン | 役割 | メリット |
| :--- | :--- | :--- | :--- |
| **1次判定 (Fast)** | **BERT (量子化済み)** | 高速なテキストベクトル分析 | 0円/1リクエスト。ミリ秒単位の応答。 |
| **2次判定 (Deep)** | **Gemini 1.5 Flash** | 文脈・矛盾・日本語の不自然さの解析 | なぜ怪しいのか？という論理的根拠を提示。 |

#### 【判定の分岐ロジック】
- **スコア < 0.45**: 「安全」と即時判定。
- **スコア > 0.55**: 「詐欺（高）」と即時判定。
- **スコア 0.45 〜 0.55**: 判定困難な「グレーゾーン」として**Gemini**へパス。

これにより、**コストを最小限に抑えつつ、難解な詐欺の手口も高精度に見抜く**ことが可能です。

---

## ✨ 主な機能

- **リアルタイム・スキャン**: Accessibility ServiceによりPlayストアの詳細画面を検知。
- **権限不一致検出**: アプリのカテゴリ（例：電卓）に対し、不自然な権限（例：連絡先アクセス）を検知。
- **根拠の提示**: Geminiの解析により、Androidアプリ上で「なぜこのアプリが危険なのか」を具体的かつ自然な日本語で解説。
- **警告オーバーレイ**: 危険度が高い場合、WindowManagerを使用してPlayストア上に警告を表示。

---

## 🏗 システムアーキテクチャ
```text
scamwall/
├── app/                        # バックエンド・AI関連の全ソースコード
│   ├── main.py                 # FastAPIエンドポイント本体
│   ├── api.py                  # 推論ロジック (BERT + Gemini)
│   ├── train_model.py          # BERTモデルの学習・評価スクリプト
│   ├── data_collector.py       # Playストアからのデータ収集ツール
│   ├── labeler.py              # 収集データのラベリング支援ツール
│   ├── test_api.py             # API接続テスト用スクリプト
│   ├── check_gpu.py            # GPU利用環境の確認ツール
│   ├── Dockerfile              # Cloud Runデプロイ用構成ファイル
│   ├── requirements.txt        # 依存ライブラリ一覧
│   ├── .env                    # APIキー等の機密情報 (Git非公開)
│   └── *.pth                   # 学習済みモデルファイル (Git非公開)
├── .gitignore                  # セキュリティ・除外設定
├── README.md                   # 本ドキュメント
└── *.csv                       # 学習用データセット (Git非公開)
```
| コンポーネント | 技術スタック | 役割 |
| :--- | :--- | :--- |
| **Android Client** | Kotlin, Accessibility Service | データ抽出 & 警告UI表示 |
| **Backend API** | Python 3.10, FastAPI, Docker | 推論エンドポイントの提供 |
| **AI/ML Engine** | PyTorch (BERT), Scikit-learn | 量子化モデルによるNLP解析 |
| **Infrastructure** | Google Cloud Run (Serverless) | 本番環境のホスティング |

---

## 🛠 技術的課題の克服

本プロジェクトのデプロイ過程で、以下の課題をDockerとパッケージ管理の最適化により解決しました。
- **依存関係の解決**: NumPy 2.xとPyTorch/OpenCVの互換性問題を解決するための環境固定。
- **コンテナの軽量化**: クラウド環境でのコールドスタートを防ぐため、CPU版PyTorchと量子化モデルを採用し、起動速度とメモリ使用量を最適化。
- **セキュリティ**: APIキーのSecret管理および`.gitignore`による徹底した機密情報保護。

---
## 👤 開発者
- **kyaraway3** - Background: 大学での数学専攻（線形代数・微分方程式）の基礎を活かしたデータ分析・ML実装。

- **Exp**: 携帯キャリアショップ運営（13年）での実務経験から、ユーザーが実際に直面するモバイルセキュリティの課題を痛感し本プロジェクトを開始。

- **Goal**: データサイエンティスト / Pythonエンジニアとしてのキャリアを追求中。

- **Note**: 本プロジェクトは現在開発および学習のフェーズにあります。機能の追加やドキュメントの更新が頻繁に行われる可能性があります。

---

## 📦 セットアップ（開発用）

```bash
# appディレクトリへ移動
cd app

# 仮想環境構築
python -m venv venv
source venv/bin/activate  # Windows: .\venv\Scripts\activate

# 依存関係のインストール
pip install -r requirements.txt

# サーバー起動
python -m uvicorn main:app --reload --port 8080

---

